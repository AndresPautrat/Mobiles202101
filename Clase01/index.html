<!DOCTYPE html>
<html>
    <head>
        <title>Clase01 ga</title>
    </head>
    <body>
        <div id="game_container"></div>
        <script src ="lib/phaser.min.js"type="text/javascript">
        </script>
        <script type = "text/javascript">
            window.onload=function(){
                console.log("ggaaa");
                //alert("gaaa");
                let game= new Phaser.Game(640,360,Phaser.AUTO,"game_container",{
                    preload: loadAssets,
                    create: creation,
                    //update:  loop
                    
                });

                let background, left;
                let direction=1;

                let animals = ["sheep", "horse", "pig", "chicken"], current_animal={}

                function loadAssets(){
                    game.load.image("background","assets/background.png");
                    game.load.image("arrow","assets/arrow.png");
                    game.load.spritesheet("chicken","assets/chicken_spritesheet.png",131,200,3);
                    game.load.spritesheet("horse","assets/horse_spritesheet.png",212,200,3);
                    game.load.spritesheet("pig","assets/pig_spritesheet.png",297,200,3);
                    game.load.spritesheet("sheep","assets/sheep_spritesheet.png",244,200,3);
                    //console.log("preload");
                }

                function creation(){
                    background = game.add.sprite(0,0,"background");

                    left = game.add.sprite(0,0,"arrow");
                    left.anchor.setTo(0.5);
                    left.x =left.width/2;
                    left.y =game.world.centerY;
                    left.scale.setTo(-1,1);
                    left.direction = "left";
                    
                    left.inputEnabled = true;
                    left.events.onInputDown.add(clickArrow);


                    right = game.add.sprite(0,0,"arrow");
                    right.anchor.setTo(0.5);
                    right.x = game.width - (right.width/2);
                    right.y = game.world.centerY;
                    right.direction = "right";

                    right.inputEnabled = true;
                    right.events.onInputDown.add(clickArrow);

                    index = game.rnd.integerInRange(0,animals.length-1)

                    current_animal = game.add.sprite(0,0,animals[index]);
                    current_animal.anchor.setTo(0.5);
                    current_animal.x = game.world.centerX;
                    current_animal.y = game.world.centerY;                    

                    current_animal.animations.add('animation', [0,1,2,1,0,1], 3, true);
                    current_animal.animations.play("animation");

                    //console.log("creation");
                }
                function clickArrow(sprite){
                    console.log(sprite.direction);
                    if(sprite.direction == "left"){
                        index = index==0?animals.length-1:index-1;
                    
                    }else{
                        index = index==animals.length-1?0:index+1;
                    }

                    new_animal=game.add.sprite(0,0,animals[index]);
                    new_animal.anchor.setTo(0.5);
                    new_animal.x=game.world.centerX;
                    new_animal.y=game.world.centerY;

                    current_animal.destroy();
                    current_animal=new_animal;
                }
                function loop(){
                    /*arrow.angle +=1;
                    arrow.y+=1*direction;
                    if(arrow.y>game.height-(arrow.height/2)){
                        arrow.y=game.height-(arrow.height/2);
                        direction*=-1;
                        arrow.scale.setTo(1.5);
                    }
                    if(arrow.y<(arrow.height/2)){
                        arrow.y=(arrow.height/2);
                        direction*=-1;
                        arrow.scale.setTo(1)
                    }*/
                    //console.log("loop");
                }
            }
        
        </script>
    </body>
</html>
